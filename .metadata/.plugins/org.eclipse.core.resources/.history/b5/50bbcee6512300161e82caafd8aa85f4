package jammazwan;

import org.apache.camel.Exchange;
import org.apache.camel.Processor;
import org.apache.camel.builder.RouteBuilder;

import com.sun.xml.bind.v2.schemagen.xmlschema.List;

public class CleanSurnameRoutes extends RouteBuilder {

	public void configure() throws Exception {
		from("file://src/main/resources/data/?noop=true&fileName=surname.csv").unmarshal("csv").split(body()).process(new Processor() {
			
			public void process(Exchange exchange) throws Exception {
				String line = exchange.getIn().getBody(String.class);
				line = line.substring(1, line.indexOf(","));
				exchange.getIn().setBody(line);
			}
		}).log(" . . . ${body}").aggregate();
	}

}